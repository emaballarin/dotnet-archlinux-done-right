# Maintainer:  Emanuele Ballarin <emanuele@ballarin.cc>
# Contributor: Brett Gilio <owner@brettgilio.com>
# Contributor: Jan de Groot <jgc@archlinux.org>
# Contributor: Mort Yao <soi@mort.ninja>
# Contributor: Balló György <ballogyor+arch at gmail dot com>

pkgname=fsharp-bin-extra
pkgver=4.5.0
pkgrel=5
pkgdesc="The F# Compiler, Core Library & Tools (F# Software Foundation Repository)"
arch=('any')
url="http://fsharp.org/"
license=('MIT')
depends=('mono' 'msbuild-stable' 'dotnet-host' 'dotnet-sdk' 'dotnet-runtime')
provides=('fsharp')
conflicts=('fsharp')
source=("fsharp-$pkgver.tar.gz::https://github.com/fsharp/fsharp/archive/$pkgver.tar.gz"
        "fsharpc-dotnet"
        "fsharpiAnyCpu-dotnet"
        "fsharpi-dotnet"
        "fsharpc"
        "fsharpiAnyCpu"
        "fsharpi"
        "fsharp-bin-extra.sh"
        )
sha256sums=('71be24bd4bac47fcad3f9e544c17f23fea9ebce3b47082720804f3f9f1b08f16'
            '41ad83eb4a9743753ece92745179764267ae5cf8263e32a273fc8c5cba561fd0'
            '75f3d284ebf32fba7f96b1d536fcdc624d15a3e51ddcb3ae911aa0aca259b6da'
            '7346376d0c0be4a41f37f6604ff9d3e404145c0c15330fa18783e768ed6da632'
            'ce1678d2d7e24cc8f2b28bee96ee0d2047ca2c37ea81b7ccf3b08f706ff4a6c1'
            '87aba4217f7dfa3f5a589d0ff7366900d20412c67531d1d5851263587ac7e45b'
            'e26ec0bf6ea6400563bdf1cc3452b73a70253e69bd658d8eecc9a4d4561985b1'
            '65de76c84161de0d78fe22cd041432a80f51b183ae0f40a4dde0255ba23dc6b5'
            )

build() {
  cd "$srcdir/fsharp-$pkgver"
  prefix=/usr
  make
}

package() {
  cd "$srcdir/fsharp-$pkgver"
  make prefix="/usr" DESTDIR="$pkgdir" install
  mv "$pkgdir/usr/bin/fsharpc" "$pkgdir/usr/bin/fsharpc-mono"
  mv "$pkgdir/usr/bin/fsharpi" "$pkgdir/usr/bin/fsharpi-mono"
  mv "$pkgdir/usr/bin/fsharpiAnyCpu" "$pkgdir/usr/bin/fsharpiAnyCpu-mono"
  cp "$srcdir/fsharpc-dotnet" "$pkgdir/usr/bin/"
  cp "$srcdir/fsharpi-dotnet" "$pkgdir/usr/bin/"
  cp "$srcdir/fsharpiAnyCpu-dotnet" "$pkgdir/usr/bin/"
  cp "$srcdir/fsharpc" "$pkgdir/usr/bin/"
  cp "$srcdir/fsharpi" "$pkgdir/usr/bin/"
  cp "$srcdir/fsharpiAnyCpu" "$pkgdir/usr/bin/"
  mkdir -p "$pkgdir/etc/profile.d/"
  cp "$srcdir/fsharp-bin-extra.sh" "$pkgdir/etc/profile.d/"
}
