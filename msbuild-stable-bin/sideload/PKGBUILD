# Maintainer:  Emanuele Ballarin <emanuele@ballarin.cc>
# Contributor: jtmb <packaging at technologicalwizardry dot com>

pkgname=msbuild-stable-bin-sideload
# msbuild_16.4+xamarinxplat.2019.09.09.15.03-0xamarin5+ubuntu1804b1_all.deb
_pkgver=16.4+xamarinxplat.2019.09.09.15.03-0xamarin5+ubuntu1804b1
pkgver=${_pkgver//[+-]/_}
pkgrel=1
pkgdesc="Xamarin implementation of the Microsoft build system"
arch=('x86_64')
depends=('mono>=5.0.0')
provides=('msbuild' 'msbuild-stable' 'msbuild-sdkresolver')
conflicts=('msbuild' 'msbuild-stable' 'msbuild-sdkresolver')
url="https://github.com/mono/msbuild"
license=('MIT')
source=("placeholder.txt")
sha256sums=('SKIP')

prepare() {
    mkdir -p "${srcdir}"
    mkdir -p "${pkgdir}"
##    mkdir -p "${srcdir}/tobepacked"
##    mkdir -p "${srcdir}/pack"
##
##    cd "${srcdir}"
##
##    wget --tries=0 --retry-connrefused --continue --progress=bar --show-progress --timeout=30 --dns-timeout=30 --random-wait http://download.mono-project.com/repo/ubuntu/pool/main/m/msbuild/msbuild-sdkresolver_${_pkgver}_all.deb
##    wget --tries=0 --retry-connrefused --continue --progress=bar --show-progress --timeout=30 --dns-timeout=30 --random-wait https://download.mono-project.com/repo/ubuntu/pool/main/m/msbuild/msbuild_${_pkgver}_all.deb
##
##    mv ./msbuild_${_pkgver}_all.deb ./msbuild.deb
##    mv ./msbuild-sdkresolver_${_pkgver}_all.deb ./resolver.deb
##
##    ar xv resolver.deb
##    mv ./data.tar.xz "${srcdir}/tobepacked"
##    cd "${srcdir}/tobepacked"
##    bsdtar xf data.tar.xz
##    chmod -R g-w usr
##    cp -R usr "${srcdir}/pack"
##
##    cd "${srcdir}"
##    rm -R -f "${srcdir}/tobepacked"
##    rm -R -f control.tar.gz data.tar.xz debian-binary
##
##    mkdir -p "${srcdir}/tobepacked"
##
##    ar xv msbuild.deb
##    mv ./data.tar.xz "${srcdir}/tobepacked"
##    cd "${srcdir}/tobepacked"
##    bsdtar xf data.tar.xz
##    chmod -R g-w usr
##    cp -R usr "${srcdir}/pack"
##
##    cd "${srcdir}"
##    rm -R -f "${srcdir}/tobepacked"
##    rm -R -f control.tar.gz data.tar.xz debian-binary
    echo '1) OK.'
}

package() {
    echo ' '
    bash -c "read -p 'Copy files by hand now!'"
    echo ' '
    ## cd "${srcdir}"
    ## mv "${srcdir}/pack/usr" "${pkgdir}"
    ## rm -f "${pkgdir}/usr/lib/mono/msbuild/15.0"
    ## rm -f "${pkgdir}/usr/lib/mono/xbuild/15.0"
    ## cp -R "${pkgdir}/usr/lib/mono/xbuild/Current" "${pkgdir}/usr/lib/mono/xbuild/15.0"
    ## cp -R "${pkgdir}/usr/lib/mono/msbuild/Current" "${pkgdir}/usr/lib/mono/msbuild/15.0"
    ## cp -R -f "/usr/lib/mono/msbuild" "${pkgdir}/usr/lib/mono/msbuild"
    ## cp -R -f "/usr/lib/mono/xbuild" "${pkgdir}/usr/lib/mono/xbuild"
    echo '2) OK.'
}
